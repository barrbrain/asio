<HTML>
  <HEAD>
    <TITLE>asio Reference: Changing an active deadline_timer&apos;s expiry time</TITLE>
    <LINK HREF="asio.css" REL="stylesheet" TYPE="text/css">
    <LINK HREF="tabs.css" REL="stylesheet" TYPE="text/css">
  </HEAD>
  <BODY BGCOLOR="#FFFFFF">
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>asio 0.3.7</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Home</A> |
            <A CLASS="qindex" HREF="../reference/index.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/index.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/index.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/index.html">Design</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>Reference</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="hierarchy.html">Class Hierarchy</A> |
            <A CLASS="qindex" HREF="classes.html">Class Index</A> |
            <A CLASS="qindex" HREF="functions.html">Member Index</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
<!-- Generated by Doxygen 1.4.7 -->
<h1><a class="anchor" name="deadline_timer_reset">Changing an active deadline_timer's expiry time</a></h1>Changing the expiry time of a timer while there are pending asynchronous waits causes those wait operations to be cancelled. To ensure that the action associated with the timer is performed only once, use something like this: used:<p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> on_some_event()
 {
   <span class="keywordflow">if</span> (my_timer.expires_from_now(seconds(5)) &gt; 0)
   {
     <span class="comment">// We managed to cancel the timer. Start new asynchronous wait.</span>
     my_timer.async_wait(on_timeout);
   }
   <span class="keywordflow">else</span>
   {
     <span class="comment">// Too late, timer has already expired!</span>
   }
 }

 <span class="keywordtype">void</span> on_timeout(<span class="keyword">const</span> <a class="code" href="a00135.html">asio::error</a>&amp; e)
 {
   <span class="keywordflow">if</span> (e != <a class="code" href="a00135.html#07d16ab7bd80c0b67c2286817d02bd47cde6760763051561f6c2ffc4ddf2be1b">asio::error::operation_aborted</a>)
   {
     <span class="comment">// Timer was not cancelled, take necessary action.</span>
   }
 }
</pre></div><p>
<ul>
<li>The <a class="el" href="a00106.html#b7698eecf0ae55bbdac33c299cfa43dc">asio::basic_deadline_timer::expires_from_now()</a> function cancels any pending asynchronous waits, and returns the number of asynchronous waits that were cancelled. If it returns 0 then you were too late and the wait handler has already been executed, or will soon be executed. If it returns 1 then the wait handler was successfully cancelled.</li>
</ul>
<ul>
<li>If a wait handler is cancelled, the <a class="el" href="a00135.html">asio::error</a> passed to it contains the value <a class="el" href="a00135.html#07d16ab7bd80c0b67c2286817d02bd47cde6760763051561f6c2ffc4ddf2be1b">asio::error::operation_aborted</a>.</li>
</ul>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="a00106.html">asio::basic_deadline_timer</a> </dd></dl>
    <DIV CLASS="qindex">
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT">
            <B>asio 0.3.7</B>
          </TD>
          <TD ALIGN="RIGHT">
            <A CLASS="qindex" HREF="../index.html">Home</A> |
            <A CLASS="qindex" HREF="../reference/index.html">Reference</A> |
            <A CLASS="qindex" HREF="../tutorial/index.html">Tutorial</A> |
            <A CLASS="qindex" HREF="../examples/index.html">Examples</A> |
            <A CLASS="qindex" HREF="../design/index.html">Design</A>
          </TD>
        </TR>
      </TABLE>
    </DIV>
  </BODY>
</HTML>
